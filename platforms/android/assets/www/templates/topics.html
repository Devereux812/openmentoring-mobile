<ion-view view-title="Topics">
  <ion-header-bar class="bar-subheader item-input-inset">
    <label class="item-input-wrapper">
      <i class="icon ion-ios-search placeholder-icon"></i>
      <input type="search"
        placeholder="Search"
        ng-model="search"
        ng-focus="searchFocused = true"
        ng-blur="searchFocused = false"
        ng-change="updateFilter()">
    </label>
    <button ng-if="search.length"
            class="button button-icon ion-android-close input-button"
            ng-click="clearSearch()">
    </button>
  </ion-header-bar>
  <ion-content>
    <ion-refresher
      ng-if="allowRefresh"
      pulling-text="Pull to refresh..."
      on-refresh="refreshTopics()">
    </ion-refresher>
    <ion-list>
      <div ng-repeat="topic in topics" ng-show="topic.isVisible">
        <ion-item class="item-stable item-icon-right">
          <a class="button button-icon icon ion-android-download" ng-show="(!topic.isLatest)" ng-click="downloadTopic(topic)"></a>
          {{topic.title}}
        </ion-item>
        <ion-item class="item item-icon-right" ng-disabled="(!topic.isDownloaded)" ng-repeat="unit in topic.units" ng-click="openUnit(unit.slug)" ng-show="unit.isVisible">
          <div>
            <i class="icon ion-chevron-right"></i>
            {{unit.title}}
          </div>
        </ion-item>
      </div>
    </ion-list>
  </ion-content>
</ion-view>
